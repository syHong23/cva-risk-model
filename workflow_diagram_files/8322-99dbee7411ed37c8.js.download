"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8322],{8322:function(e,t,n){n.d(t,{K5:function(){return E},Ql:function(){return O},Z1:function(){return P},_A:function(){return y},nJ:function(){return T},rN:function(){return S},wy:function(){return I},z6:function(){return w}});var r=n(36091),o=n(8571),u=n(40287),a=n(27218),i=n(27895),c=n(18850),l=n(78664),s=n(35228),d=n(6385),f=n(13262);n(92841);var v=n(87033),p=n(77930),m=n(81695),g=n(7653),h=n(19170),_=n(93513),C=n(68571);let w=()=>{let e=(0,m.useRouter)(),t=(0,u.f)();return{refresh:()=>{e.refresh()},switchAndRefresh:(e,n)=>{t.set(d.cn.LAST_ACTIVE_ORG,e),n?location.pathname=n:location.reload()}}},k=e=>{let{account:t}=(0,a.t)(),n=(0,l.gt)(e),o=(0,r.Wc)();return((0,g.useEffect)(()=>{t&&o()},[t,o]),t&&((0,s.wJ)({account:t,isClaudeDot:e})||(0,s.c6)(t,e)))?"/onboarding":t&&(0,s.kK)(t,e)?"/invites":t&&(0,s.D_)(t,e)?"/create":t&&n?"/upgrade":e?"/new":"/dashboard"};function E(e){let{value:t}=(0,v.FL)("show_affirmative_consent"),{value:n}=(0,v.FL)("show_affirmative_consent_for_privacy_policy");return(0,g.useMemo)(()=>[...t===e?["aup","consumer-terms"]:[],...n===e?["privacy"]:[]],[n,t,e])}let S=(e,t,n)=>{let r=(0,c.q)(),{mutateAsync:o}=(0,h.k7)();return(0,g.useCallback)(async()=>{if(!e||!r||0===t.length)return;let u=t.map(e=>({document_id:"v3:".concat(e,":").concat(r[e]),accepted_via_checkbox:n}));await o({acceptances:u})},[e,r,t,o,n])},y=(e,t)=>{let{account:n,refetch:r,setActiveOrganizationUUID:o}=(0,a.t)(),[u,c]=(0,g.useState)(!1),[l,s]=(0,g.useState)(!1),d=T(),{addSuccess:v}=(0,i.e)(),{data:m}=(0,h.gq)(e),_=(0,p.useQueryClient)();return(0,g.useEffect)(()=>{n&&u&&l&&(t?t(d):d())},[l,d,u,n,t]),(0,g.useCallback)(async()=>{var e,t;c(!0);let n=await r();await _.invalidateQueries({queryKey:[f.eW]}),(null==m?void 0:m.organization_uuid)&&(o(m.organization_uuid),v("Successfully joined ".concat(m.organization_name))),n&&(null===(t=window.google)||void 0===t?void 0:null===(e=t.accounts)||void 0===e?void 0:e.id)&&window.google.accounts.id.cancel(),s(!0)},[m,v,r,o,_])},T=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,m.useSearchParams)().get("returnTo"),n=I(e);return(0,g.useCallback)(()=>{n(t)},[n,t])},I=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{account:t}=(0,a.t)(),[n,r]=(0,g.useState)(!1),u=(0,m.useRouter)(),[i,c]=(0,g.useState)(null),l=(0,m.usePathname)(),s=(0,m.useSearchParams)(),d=(0,o.Zx)(),f=k(d);return(0,g.useEffect)(()=>{(n||e)&&!t&&u.push((0,_.C2)(l,s.toString()))},[t,u,n,e,l,s]),(0,g.useEffect)(()=>{if(n&&t){let e=(0,_.eX)(t,i,f,d,!!C.env.NEXT_PUBLIC_SHOW_US_GOVT_SYSTEM_USE_NOTIFICATION);e!==window.location.href.replace(window.location.origin,"")&&(u.push(e),u.refresh())}},[t,u,n,i,f,d]),(0,g.useCallback)(e=>{e&&c(decodeURIComponent(e)),r(!0)},[])};function P(){let[e,t]=(0,g.useState)(!1);return{getRecaptchaToken:(0,g.useCallback)(async(e,n)=>C.env.NEXT_PUBLIC_DISABLE_RECAPTCHA?Promise.resolve("recaptcha-ignore-token"):(t(!0),new Promise((r,o)=>{if("undefined"==typeof grecaptcha)return t(!1),o(Error("Recaptcha failed to load"));grecaptcha.enterprise.ready(()=>{grecaptcha.enterprise.execute(e,{action:n}).then(e=>{r(e),t(!1)},e=>{t(!1),o(e)})})})),[]),isLoading:e}}function O(e){let[t,n]=(0,g.useState)(!1);(0,g.useEffect)(()=>{if(!t){let t=setInterval(()=>{(window.grecaptcha||C.env.NEXT_PUBLIC_DISABLE_RECAPTCHA)&&(n(!0),e())},10);return()=>clearInterval(t)}},[t,n,e])}},93513:function(e,t,n){n.d(t,{$6:function(){return c},C2:function(){return a},G9:function(){return i},eX:function(){return u},kY:function(){return l}});var r=n(35228),o=n(6385);let u=(e,t,n,u,a)=>{if(a&&!localStorage.getItem(o.VJ.ACCEPTED_US_GOVERNMENT_SYSTEM_NOTIFICATION))return"/us-govt-system-warning";if(!t||!t.startsWith("/"))return n;if((0,r.cG)(e,u)){let e=new URL(n,window.location.origin),r=new URLSearchParams(e.search);return r.set("returnTo",t),"".concat(e.pathname,"?").concat(r.toString())}return i(t)},a=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/login",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="".concat(e,"?").concat(t),u=new URLSearchParams(r);return u.append("returnTo",o),"".concat(n,"?").concat(u.toString())};function i(e){let t=new URL(e,"http://example.com");return t.pathname.replace(/^\/+/,"/")+t.search}function c(e){return e.reduce((e,t)=>{let n=localStorage.getItem(t);return null!==n&&e.push([t,n]),e},[])}function l(e){e.forEach(e=>{let[t,n]=e;localStorage.setItem(t,n)})}},36091:function(e,t,n){n.d(t,{ArkoseTokenProvider:function(){return h},Wc:function(){return C},mj:function(){return _}});var r=n(27573),o=n(5362),u=n(87033),a=n(88755),i=n(45144),c=n(27522),l=n(7653),s=n(41270),d=n(8571),f=n(18013);let v="ak-session-token",p=e=>{let{host:t,apiKey:n,nonce:o,onCompleted:a,onShown:d,onShow:f,onHide:v,onError:p,setArkoseEnforcement:m}=e,g=e=>{e.setConfig({onCompleted:a,onShown:d,onShow:f,onHide:v,onError:p}),m(e)};(0,l.useEffect)(()=>()=>{window.setupEnforcement=void 0},[]);let h=(0,u.Zr)("ak_integrity","integrity","",s.z.string());return(0,r.jsx)(c.default,{id:"arkose-script",src:"https://".concat(t,"/v2/").concat(n,"/api.js"),type:"text/javascript","data-callback":"setupEnforcement",async:!0,defer:!0,onLoad:()=>{window.setupEnforcement||(window.setupEnforcement=g)},onError:e=>(0,i.Tb)(e),nonce:o,integrity:h,crossOrigin:"anonymous"})},m=()=>{let e=(0,a.Q)(),t=(0,d.Zx)(),{value:n}=(0,u.FL)("ak_enabled");return!e&&t&&n},g=(0,l.createContext)({isReady:!1,isChallenging:!1,lastCallerId:void 0,needsToken:!1,startTokenFlow:()=>{}});function h(e){let{host:t,apiKey:n,nonce:o,children:u}=e,a=m(),[c,s]=(0,l.useState)(void 0),[d,h]=(0,l.useState)(void 0),[_,C]=(0,l.useState)(!1),[w,k]=(0,f.R)(v,void 0),E=a&&!w&&!!t&&!!n;return(0,r.jsxs)(g.Provider,{value:{isReady:!!c,isChallenging:_,needsToken:E,lastCallerId:d,startTokenFlow:e=>{h(e),null==c||c.run()}},children:[u,a&&t&&n&&(0,r.jsx)(p,{host:t,apiKey:n,nonce:o,onCompleted:e=>{k(e.token)},onShown:()=>C(!0),onShow:()=>C(!0),onHide:()=>C(!1),onError:e=>{(0,i.Tb)(e.error)},setArkoseEnforcement:s})]})}function _(){return(0,l.useContext)(g)}let C=()=>{let e=m(),[t,n,r]=(0,f.R)(v,void 0),{mutateAsync:u}=(0,o.uC)("api/arkose/verify","POST");return(0,l.useCallback)(async()=>{e&&t&&(r(),await u({session_token:t}))},[e,u,t,r])}},18850:function(e,t,n){n.d(t,{LegalDocsProvider:function(){return a},q:function(){return i}});var r=n(27573),o=n(7653);let u=(0,o.createContext)(void 0),a=e=>{let{value:t,children:n}=e;return(0,r.jsx)(u.Provider,{value:t,children:n})};function i(){return(0,o.useContext)(u)}},37891:function(e,t,n){n.d(t,{QD:function(){return r},pO:function(){return o},rK:function(){return u}});let r=["proMonthlyPromoCode","welcomeMessageTitle","utmParams","max5xMonthlyPromoCode","max20xMonthlyPromoCode"],o=e=>{if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},u=(e,t)=>(null==t?void 0:t.overrides)?{...e,...t.overrides}:e},78664:function(e,t,n){n.d(t,{Iq:function(){return h},fk:function(){return m},gt:function(){return g},jN:function(){return p},s$:function(){return v}});var r=n(5362),o=n(40287),u=n(27895),a=n(6385),i=n(13262),c=n(87033),l=n(7653),s=n(40950),d=n(41270),f=n(37891);function v(){var e;let t=(0,o.f)(),n=null!==(e=t.get(a.cn.PROMOTION))&&void 0!==e?e:null;return{data:(0,f.pO)(n),mutate:(0,l.useCallback)(e=>{t.set(a.cn.PROMOTION,JSON.stringify(e),{maxAgeSeconds:7776e3})},[t]),delete:(0,l.useCallback)(()=>{t.delete(a.cn.PROMOTION)},[t])}}function p(){var e,t,n;let{data:o}=v(),u=(t=null!==(e=null==o?void 0:o.promotionId)&&void 0!==e?e:null,n=e=>(0,f.rK)(e,o),(0,r.WE)("/api/billing/promotion/".concat(t),{queryKey:[i.Lx,t],enabled:!!t,meta:{noToast:!0}},e=>(e.promotionId=t,n)?n(e):e));return{...u,isPending:u.isPending&&!!(null==o?void 0:o.promotionId)}}function m(){let{data:e,mutate:t}=v();(0,l.useEffect)(()=>{(null==e?void 0:e.needsCheckout)&&(e.needsCheckout=void 0,t(e))},[e,t])}function g(e){let{data:t,mutate:n}=v(),r=null==t?void 0:t.promotionId,o=(0,c.Zr)("claude_ai_targeted_promotion","promotionId",null,d.z.string().nullable());return(0,l.useEffect)(()=>{!r&&o&&n({promotionId:o})},[r,o,n]),!!e&&!!(null==t?void 0:t.needsCheckout)&&!!(null==t?void 0:t.promotionId)}let h=()=>{let e=(0,l.useRef)(!1),t=(0,u.e)(),n=(0,s.Z)(),{delete:r}=v();return(0,l.useCallback)(o=>{(null==o?void 0:o.offerError)&&!e.current&&(e.current=!0,t.addError(n.formatMessage({defaultMessage:"This promotion is not available for your account",id:"Vu9kt6ezVH"})),r())},[t,r,n])}}}]);